<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SavFit 0.4 ‚Äì Fitness Tracker</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
 --accent:#ff6600;
 --bg:#000;
 --text:#fff;
}
html,body{
 margin:0;padding:0;height:100%;width:100%;
 background:var(--bg);color:var(--text);
 font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
 overflow:hidden;
}
.hidden{display:none!important;}
button{
 background:var(--accent);color:#fff;border:none;
 padding:10px 16px;margin:6px;font-size:16px;
 border-radius:6px;cursor:pointer;
}
button:active{transform:scale(0.96);}
h1,h2,h3,h4{color:var(--accent);margin:6px 0;}
input,select{
 padding:6px;border-radius:4px;border:1px solid #333;
 background:#111;color:#fff;font-size:15px;
}
.container{
 position:absolute;top:50px;left:0;width:100%;height:calc(100% - 50px);
 overflow-y:auto;padding:10px 8px;box-sizing:border-box;
}
.card{
 background:#111;padding:12px;border-radius:8px;margin-bottom:10px;
 box-shadow:0 0 6px rgba(255,102,0,0.2);
}
#topbar{
 position:fixed;top:0;left:0;width:100%;height:50px;
 background:#111;border-bottom:2px solid var(--accent);
 display:flex;align-items:center;justify-content:space-between;
 color:var(--accent);padding:0 12px;z-index:999;
}
#backBtn{
 background:none;border:none;color:var(--accent);
 font-size:22px;padding:4px 8px;cursor:pointer;
}
#topTitle{font-size:18px;margin:0;}
.fade{animation:fade 0.25s ease-in-out;}
@keyframes fade{from{opacity:0;}to{opacity:1;}}
/* Splash */
#splash{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:#000 url('https://i.postimg.cc/jq9R7f9B/file-00000000057471f481be9e892c4c9aed-2.jpg') center/contain no-repeat;
 display:flex;align-items:flex-end;justify-content:center;
 flex-direction:column;text-align:center;color:var(--accent);
}
#splash p{margin-bottom:60px;font-size:18px;}
/* Main menu */
#menu img{
 width:90%;max-width:300px;margin:20px auto;display:block;
}
.menu-btn{
 width:90%;max-width:320px;display:block;margin:8px auto;
}
/* Dashboard */
.exercise-card{
 background:#111;padding:10px;border-radius:8px;margin:8px 0;
}
.exercise-header{
 display:flex;justify-content:space-between;align-items:center;
 color:var(--accent);
}
.sets-grid{
 display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));
 gap:6px;margin-top:6px;
}
.notes-popup{
 position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
 background:#000;padding:20px;border:2px solid var(--accent);
 border-radius:10px;width:90%;max-width:350px;z-index:9999;
 display:none;color:#fff;
}
.notes-popup ul{margin:0 0 10px 16px;text-align:left;}
/* Modal overlay */
.modal{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:rgba(0,0,0,0.9);display:none;
 align-items:center;justify-content:center;flex-direction:column;
 z-index:9999;color:var(--accent);
}
.spinner{
 border:4px solid #111;border-top:4px solid var(--accent);
 border-radius:50%;width:60px;height:60px;
 animation:spin 1s linear infinite;margin-bottom:15px;
}
@keyframes spin{from{transform:rotate(0);}to{transform:rotate(360deg);}}
/* Charts */
#progressChart{width:100%;max-width:400px;height:260px;}
/* Scrollbar */
::-webkit-scrollbar{width:6px;}
::-webkit-scrollbar-thumb{background:var(--accent);}
</style>
</head>
<body>

<!-- Splash -->
<div id="splash">
  <p>Loading up your gains‚Ä¶</p>
</div>

<!-- Top bar -->
<div id="topbar" class="hidden">
  <button id="backBtn" onclick="navBack()">‚Üê</button>
  <h1 id="topTitle">SavFit</h1>
  <div style="width:28px"></div>
</div>

<!-- Sections -->
<div id="menu" class="container hidden">
  <img src="https://i.postimg.cc/VvwcL95D/file-00000000f1a8720a93b97d8839c5e55e.png" alt="SavFit logo">
  <button class="menu-btn" onclick="showSection('dashboard')"><i class="fa-solid fa-dumbbell"></i> Dashboard</button>
  <button class="menu-btn" onclick="showSection('log')"><i class="fa-solid fa-calendar-days"></i> Exercise Log</button>
  <button class="menu-btn" onclick="showSection('progress')"><i class="fa-solid fa-chart-line"></i> Progress Summary</button>
  <button class="menu-btn" onclick="showSection('backup')"><i class="fa-solid fa-database"></i> Backup / Restore</button>
  <button class="menu-btn" onclick="showSection('settings')"><i class="fa-solid fa-gear"></i> Settings</button>
  <button class="menu-btn" onclick="showSection('help')"><i class="fa-solid fa-circle-question"></i> Help / About</button>
</div>

<!-- Dashboard -->
<div id="dashboard" class="container hidden">
  <img src="https://i.postimg.cc/jSH3RVPg/file-00000000673871f4a581a91702a2faa8.png" alt="Dashboard image" style="width:90%;max-width:320px;display:block;margin:10px auto;">
  <h2>Workout Dashboard</h2>
  <label>Date: <input type="date" id="workoutDate"></label><br>
  <label>Focus: 
   <select id="focusSelect">
    <option>Make a selection</option>
    <option>Chest & Back</option>
    <option>Legs & Glutes</option>
    <option>Shoulders & Mixed</option>
    <option>Custom</option>
   </select>
  </label>
  <div id="exerciseList"></div>
  <button id="addExerciseBtn">‚ûï Add Exercise</button>
  <button id="endWorkoutBtn">‚úÖ End Workout</button>
</div>

<!-- Other section placeholders -->
<div id="log" class="container hidden"></div>
<div id="progress" class="container hidden"></div>
<div id="backup" class="container hidden"></div>
<div id="settings" class="container hidden"></div>
<div id="help" class="container hidden"></div>

<!-- Loader modal -->
<div id="loader" class="modal">
  <div class="spinner"></div>
  <p>Saving your gains‚Ä¶</p>
</div>

<script>
/* Initial setup */
let current='splash';
function showSection(id){
  document.getElementById(current)?.classList.add('hidden');
  document.getElementById(id)?.classList.remove('hidden');
  current=id;
  document.getElementById('topbar').classList.toggle('hidden', id==='splash');
  document.getElementById('topTitle').textContent=
   id==='menu'?'SavFit':
   id[0].toUpperCase()+id.slice(1);
}
function navBack(){
  if(current==='menu' || current==='splash') return;
  showSection('menu');
}
window.addEventListener('load',()=>{
  setTimeout(()=>{document.getElementById('splash').classList.add('hidden');showSection('menu');},1500);
});
</script>
<!-- ==== PART 2: DASHBOARD LOGIC ==== -->
<script>
/* ====== SavFit 0.4 Data & Defaults ====== */
const defaultExercises = {
  "Chest & Back":[
    {name:"Flat Dumbbell Bench Press",notes:[
      "Shoulders back and down","Feet always touching the floor",
      "Back arch","Elbows at 45¬∞","Power from chest not arms"]},
    {name:"Pull-Ups or Lat Pulldown",notes:[
      "Overhand grip just over shoulder width","Drive elbows back",
      "Hold pull at bottom for a second"]},
    {name:"Incline Dumbbell Bench Press",notes:[
      "Bench at 35‚Äì45¬∞","Use knees to lift weights up"]},
    {name:"Bent-Over Row",notes:[
      "Back aligned, core braced","Bar pulled straight up to lower chest"]},
    {name:"Dumbbell Fly",notes:[
      "Lower weight, slow reps","Feel chest stretch","Slight bend in elbows"]}
  ],
  "Legs & Glutes":[
    {name:"Back Squat",notes:[
      "Grip close, elbows forward","Bar on upper traps","Back straight","Push through heels"]},
    {name:"Romanian Deadlift",notes:[
      "Legs shoulder width","Slight bend","Straight back"]},
    {name:"Standing Calf Raise",notes:[
      "One leg at a time","Hold top and bottom"]},
    {name:"Seated Calf Raise",notes:[
      "Hold top and bottom","Use step if no machine"]},
    {name:"Walking Dumbbell Lunges",notes:[
      "Weight on heels when pushing","Core upright"]},
    {name:"Hip Thrust",notes:[
      "Depth adequate","Squeeze glutes at top"]}
  ],
  "Shoulders & Mixed":[
    {name:"Deadlift",notes:[
      "Bar over mid-foot","Drive through heels","Tense core/back"]},
    {name:"Overhead Barbell Press",notes:[
      "Hands over shoulder width","Forearms straight up","Don‚Äôt flare elbows"]},
    {name:"Dumbbell Lateral Raise",notes:[
      "Light dumbbells","Slight bend elbows","Controlled motion"]},
    {name:"Dumbbell Rear Delt Raise",notes:[
      "Bent-over row stance","Feel in rear delts"]},
    {name:"Ab Roller",notes:[
      "Slow controlled motion","Hold extended","Tense core"]},
    {name:"Weighted Russian Twists",notes:[
      "Twist fully side to side","Keep tension in abs"]}
  ]
};
const optionalExercises=[
  "Bicep Curls","Hammer Curls","Skull Crushers","Close-Grip Bench",
  "Tricep Hybrid","5-Minute Core Blast","Wood Cutter","Leg Extension","Hamstring Curl"
];

let sfState=JSON.parse(localStorage.getItem('savfitState')||'{"logs":[]}');
let currentWorkout={date:"",focus:"",data:[]};

/* ====== UI Builders ====== */
const listEl=document.getElementById('exerciseList');
const focusSel=document.getElementById('focusSelect');
const dateInput=document.getElementById('workoutDate');
const addBtn=document.getElementById('addExerciseBtn');
const endBtn=document.getElementById('endWorkoutBtn');

/* --- populate exercises when focus selected --- */
focusSel.addEventListener('change',()=>{
  populateExercises(focusSel.value);
});
function populateExercises(focus){
  listEl.innerHTML='';
  const exList=defaultExercises[focus]||[];
  currentWorkout.focus=focus;
  exList.forEach(ex=>addExerciseCard(ex.name,ex.notes));
}

/* --- add exercise card --- */
function addExerciseCard(name,notes=[]){
  const card=document.createElement('div');
  card.className='exercise-card';
  card.innerHTML=`
    <div class="exercise-header">
      <strong>${name}</strong>
      <div>
        <button onclick="openNotes(this)" title="Notes"><i class='fa fa-note-sticky'></i></button>
        <button onclick="removeExercise(this)" title="Delete"><i class='fa fa-trash'></i></button>
      </div>
    </div>
    <label>Weight (kg): <input type="number" min="0" class="exWeight"></label><br>
    <label>Difficulty: 
      <select class="exDiff">
        <option value="1">1</option><option value="2">2</option>
        <option value="3">3</option><option value="4">4</option>
        <option value="5">5</option>
      </select>
    </label>
    <label>Form: 
      <select class="exForm">
        <option value="1">1</option><option value="2">2</option>
        <option value="3">3</option><option value="4">4</option>
        <option value="5">5</option>
      </select>
    </label>
    <div class="sets-grid">
      ${[1,2,3].map(i=>`<input type='number' min='0' placeholder='Reps ${i}' class='reps'>`).join('')}
    </div>
    <button onclick="saveSet(this)">üíæ Save Set</button>
    <button onclick="startRest()">üïí Start Rest</button>
  `;
  card.dataset.notes=JSON.stringify(notes);
  listEl.appendChild(card);
}

/* --- remove exercise --- */
function removeExercise(btn){
  btn.closest('.exercise-card').remove();
}

/* --- notes popup --- */
function openNotes(btn){
  const notes=JSON.parse(btn.closest('.exercise-card').dataset.notes||'[]');
  const pop=document.createElement('div');
  pop.className='notes-popup';
  pop.innerHTML=`<ul>${notes.map(n=>`<li>${n}</li>`).join('')}</ul>
  <button onclick="this.parentElement.remove()">Close</button>`;
  document.body.appendChild(pop);
  pop.style.display='block';
}

/* --- save set --- */
function saveSet(btn){
  const card=btn.closest('.exercise-card');
  const name=card.querySelector('strong').innerText;
  const w=parseFloat(card.querySelector('.exWeight').value)||0;
  const d=card.querySelector('.exDiff').value;
  const f=card.querySelector('.exForm').value;
  const reps=[...card.querySelectorAll('.reps')].map(r=>r.value||0);
  let ex=currentWorkout.data.find(e=>e.name===name);
  if(!ex){ex={name,weight:w,difficulty:d,form:f,reps};currentWorkout.data.push(ex);}
  else{ex.weight=w;ex.difficulty=d;ex.form=f;ex.reps=reps;}
  localStorage.setItem('savfitCurrent',JSON.stringify(currentWorkout));
  vibrate(40);
}

/* --- rest timer --- */
function startRest(){
  const modal=document.getElementById('loader');
  modal.querySelector('p').innerText='Rest timer‚Ä¶';
  modal.style.display='flex';
  let sec=parseInt(localStorage.getItem('restTime')||'60');
  const p=modal.querySelector('p');
  const timer=setInterval(()=>{
    p.innerText=`Rest: ${sec}s`;
    if(sec<=0){clearInterval(timer);modal.style.display='none';vibrate(600);}
    sec--;
  },1000);
}

/* --- add exercise manually --- */
addBtn.addEventListener('click',()=>{
  const all=[...Object.values(defaultExercises).flat().map(e=>e.name),...optionalExercises];
  const name=prompt("Add Exercise:\nChoose or type new:",all[0]||"");
  if(name){addExerciseCard(name);}
});

/* --- end workout --- */
endBtn.addEventListener('click',()=>{
  currentWorkout.date=dateInput.value||new Date().toISOString().slice(0,10);
  if(!currentWorkout.focus){alert("Select a focus first");return;}
  if(!currentWorkout.data.length){alert("No exercises");return;}
  sfState.logs.push(JSON.parse(JSON.stringify(currentWorkout)));
  localStorage.setItem('savfitState',JSON.stringify(sfState));
  localStorage.removeItem('savfitCurrent');
  alert("Workout saved ‚úÖ");
  currentWorkout={date:"",focus:"",data:[]};
  showSection('menu');
});

/* --- vibration helper --- */
function vibrate(ms){try{if('vibrate'in navigator)navigator.vibrate(ms);}catch(e){};}
</script>
<!-- ==== PART 3: LOG / PROGRESS / BACKUP / SETTINGS ==== -->
<script>
/* ========== Exercise Log ========== */
function renderLog(){
  const el=document.getElementById('log');
  el.innerHTML='<h2>Exercise Log</h2>';
  if(!sfState.logs.length){el.innerHTML+='<p>No workouts saved yet.</p>';return;}
  sfState.logs.slice().reverse().forEach((l,i)=>{
    const c=document.createElement('div');c.className='card';
    c.innerHTML=`<strong>${l.date}</strong> ‚Äì ${l.focus}
      <button onclick="viewWorkout(${sfState.logs.length-1-i})">View</button>`;
    el.appendChild(c);
  });
}
function viewWorkout(idx){
  const l=sfState.logs[idx];
  const det=document.createElement('div');
  det.className='notes-popup';
  det.innerHTML=`<h3>${l.date} ‚Äì ${l.focus}</h3>
    <table style="width:100%;color:#fff;font-size:13px;border-collapse:collapse;">
    <tr style="color:var(--accent)"><th>Exercise</th><th>W</th><th>Reps</th><th>D</th><th>F</th></tr>
    ${l.data.map(d=>`<tr><td>${d.name}</td><td>${d.weight}</td>
      <td>${d.reps.join('/')}</td><td>${d.difficulty}</td><td>${d.form}</td></tr>`).join('')}
    </table>
    <button onclick="this.parentElement.remove()">Close</button>`;
  document.body.appendChild(det);det.style.display='block';
}

/* ========== Progress Chart ========== */
function renderProgress(){
  const el=document.getElementById('progress');
  el.innerHTML=`<h2>Progress Summary</h2>
  <select id="progSelect"></select><canvas id="progressChart"></canvas>`;
  const s=document.getElementById('progSelect');
  const exNames=[...new Set(sfState.logs.flatMap(l=>l.data.map(d=>d.name)))];
  if(!exNames.length){el.innerHTML+='<p>No exercise data yet.</p>';return;}
  exNames.forEach(n=>{const o=document.createElement('option');o.text=n;o.value=n;s.appendChild(o);});
  s.addEventListener('change',()=>drawChart(s.value));
  drawChart(exNames[0]);
}
function drawChart(name){
  const ctx=document.getElementById('progressChart');
  const data=sfState.logs.filter(l=>l.data.some(d=>d.name===name))
    .map(l=>{
      const d=l.data.find(x=>x.name===name);
      return {x:l.date,y:parseFloat(d.weight)||0,detail:d};
    });
  if(window.progChart)window.progChart.destroy();
  window.progChart=new Chart(ctx,{
    type:'line',
    data:{datasets:[{label:name,data,borderColor:'#ff6600',backgroundColor:'rgba(255,102,0,0.3)',tension:0.3}]},
    options:{
      scales:{x:{type:'category',labels:data.map(p=>p.x)}},
      onClick:(evt,els)=>{
        if(els.length){
          const pt=data[els[0].index];
          alert(`${pt.x}\n${pt.detail.name}\nWeight:${pt.detail.weight}kg\nReps:${pt.detail.reps.join('/')}\nDiff:${pt.detail.difficulty}\nForm:${pt.detail.form}`);
        }
      }
    }
  });
}

/* ========== Backup / Restore ========== */
function renderBackup(){
  const el=document.getElementById('backup');
  el.innerHTML=`<h2>Backup & Restore</h2>
  <button onclick="exportCSV()">Export CSV</button>
  <input type="file" id="fileInput" accept=".csv" style="display:none" onchange="importCSV(event)">
  <button onclick="document.getElementById('fileInput').click()">Import CSV</button>`;
}
function exportCSV(){
  if(!sfState.logs.length){alert('No data to export.');return;}
  let csv='Date,Focus,Exercise,Weight,Reps,Difficulty,Form\n';
  sfState.logs.forEach(l=>{
    l.data.forEach(d=>{
      csv+=`${l.date},${l.focus},"${d.name}",${d.weight},"${d.reps.join('/')}",${d.difficulty},${d.form}\n`;
    });
  });
  const blob=new Blob([csv],{type:'text/csv'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);a.download='SavFit_Backup.csv';a.click();
  URL.revokeObjectURL(a.href);
  alert('Backup exported ‚úÖ');
}
function importCSV(e){
  const f=e.target.files[0];if(!f)return;
  const r=new FileReader();
  r.onload=function(ev){
    const lines=ev.target.result.trim().split(/\r?\n/).slice(1);
    const logs=[];
    lines.forEach(line=>{
      const [date,focus,name,w,reps,diff,form]=line.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/);
      let log=logs.find(x=>x.date===date&&x.focus===focus);
      if(!log){log={date,focus,data:[]};logs.push(log);}
      log.data.push({name:name.replace(/"/g,''),weight:w,reps:reps.replace(/"/g,'').split('/'),
        difficulty:diff,form});
    });
    sfState.logs=logs;
    localStorage.setItem('savfitState',JSON.stringify(sfState));
    alert('Backup restored ‚úÖ');
  };
  r.readAsText(f);
}

/* ========== Settings ========== */
function renderSettings(){
  const el=document.getElementById('settings');
  el.innerHTML=`<h2>Settings</h2>
    <label>Default rest (sec): <input type="number" id="restInput" min="5" max="300" value="${localStorage.getItem('restTime')||60}"></label><br>
    <label><input type="checkbox" id="vibChk" ${localStorage.getItem('vib')!=='0'?'checked':''}> Enable vibration</label><br>
    <button onclick="saveSettings()">Save Settings</button>
    <p>Version 0.4</p>`;
}
function saveSettings(){
  localStorage.setItem('restTime',document.getElementById('restInput').value);
  localStorage.setItem('vib',document.getElementById('vibChk').checked?'1':'0');
  alert('Settings saved.');
}
</script>
<!-- ==== PART 4: HELP / ABOUT / SHARE / NAVIGATION ==== -->
<script>
/* ===== Help & About ===== */
function renderHelp(){
  const el=document.getElementById('help');
  el.innerHTML=`
  <h2>Help & About</h2>
  <div class="card" style="text-align:left;">
  <h3>Using SavFit</h3>
  <ul>
    <li>Select your workout focus: Chest & Back, Legs & Glutes, or Shoulders & Mixed.</li>
    <li>Add or remove exercises as needed, or create your own.</li>
    <li>Record weight (kg), reps, difficulty (1‚Äì5) and form (1‚Äì5).</li>
    <li>Tap üíæ to save each exercise. Use üïí to start your rest timer.</li>
    <li>Use End Workout to save your session and return home.</li>
    <li>Open Exercise Log to view or compare previous workouts.</li>
    <li>Progress Summary shows charts of your weights over time.</li>
    <li>Use Backup / Restore to export or import your data as CSV.</li>
  </ul>
  <p style="margin-top:15px;">Created for Savita by the best bro ever ‚ù§Ô∏è</p>
  </div>`;
}

/* ===== Share App ===== */
function shareApp(){
  const shareData={
    title:"SavFit 0.4",
    text:"Track your gains üí™ with SavFit!",
    url:window.location.href
  };
  if(navigator.share){navigator.share(shareData).catch(()=>{});}
  else{prompt("Copy this SavFit link:",window.location.href);}
}

/* ===== Navigation & Initial Render ===== */
function renderSection(id){
  if(id==="log")renderLog();
  else if(id==="progress")renderProgress();
  else if(id==="backup")renderBackup();
  else if(id==="settings")renderSettings();
  else if(id==="help")renderHelp();
}
function showSection(id){
  document.getElementById(current)?.classList.add('hidden');
  document.getElementById(id)?.classList.remove('hidden');
  current=id;
  document.getElementById('topbar').classList.toggle('hidden',id==='splash');
  const titles={menu:'SavFit',dashboard:'Workout',log:'Exercise Log',progress:'Progress',
                backup:'Backup / Restore',settings:'Settings',help:'Help / About'};
  document.getElementById('topTitle').textContent=titles[id]||'SavFit';
  renderSection(id);
}
function navBack(){
  if(current==='menu'||current==='splash')return;
  showSection('menu');
}

/* ===== App Start ===== */
window.addEventListener('load',()=>{
  setTimeout(()=>{
    document.getElementById('splash').classList.add('hidden');
    showSection('menu');
  },1500);
});
</script>
</body>
</html>
