<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SavFit 0.3</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js">
<style>
html,body{margin:0;padding:0;background:#000;color:#FF6600;font-family:Arial,Helvetica,sans-serif;}
button{background:#FF6600;color:#fff;border:none;padding:10px 16px;border-radius:8px;font-size:16px;}
button:active{background:#FF3300;}
.hidden{display:none;}
/* SPLASH */
#splash{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:#000 url('https://i.postimg.cc/jq9R7f9B/file-00000000057471f481be9e892c4c9aed-2.jpg')
 no-repeat center center/cover;
 display:flex;flex-direction:column;align-items:center;justify-content:flex-end;
 color:#FF6600;z-index:1000;
}
#splash p{margin:40px 0;font-size:20px;text-shadow:0 0 10px #FF6600;}
/* MAIN MENU */
#menu{display:none;flex-direction:column;align-items:center;padding:20px;}
#menu img{width:80%;max-width:500px;margin-top:20px;border-radius:10px;}
.menu-btn{width:80%;max-width:300px;margin:12px;}
</style>
</head>
<body>

<!-- Splash -->
<div id="splash">
  <p>Loading up your gains...</p>
</div>

<!-- Main Menu -->
<div id="menu">
  <img src="https://i.postimg.cc/VvwcL95D/file-00000000f1a8720a93b97d8839c5e55e.png" alt="SavFit Header">
  <button class="menu-btn" onclick="showSection('dashboard')">üèãÔ∏è Start Workout</button>
  <button class="menu-btn" onclick="showSection('progress')">üìà Progress</button>
  <button class="menu-btn" onclick="showSection('settings')">‚öôÔ∏è Settings</button>
  <button class="menu-btn" onclick="showSection('help')">‚ùì Help</button>
  <button class="menu-btn" onclick="showSection('about')">‚ÑπÔ∏è About</button>
  <button class="menu-btn" onclick="openLog()">üóìÔ∏è Exercise Log</button>
  <button class="menu-btn" onclick="openBackup()">üíæ Backup & Restore</button>
</div>

<!-- SECTION CONTAINERS -->
<div id="dashboard" class="hidden"></div>
<div id="progress" class="hidden"></div>
<div id="settings" class="hidden"></div>
<div id="help" class="hidden"></div>
<div id="about" class="hidden"></div>

<script>
/* SPLASH HANDLER */
window.addEventListener('load',()=>{
  setTimeout(()=>{
    document.getElementById('splash').style.display='none';
    document.getElementById('menu').style.display='flex';
  },2500);
});

/* SECTION NAVIGATION */
function showSection(id){
  document.querySelectorAll('#menu,#dashboard,#progress,#settings,#help,#about')
          .forEach(el=>el.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}
</script>

<!-- ==== END PART 1 ==== -->
<!-- ==== PART 2: DASHBOARD ==== -->
<style>
/* Dashboard styles */
#dashboard{padding:10px 0 80px;text-align:center;}
#dashboard img{width:80%;max-width:480px;margin-top:10px;border-radius:10px;}
input,select{background:#111;color:#fff;border:1px solid #FF6600;
 border-radius:6px;padding:6px;margin:3px;}
.exercise-card{border:1px solid #FF6600;border-radius:8px;margin:10px;padding:10px;text-align:left;}
.set-field{display:flex;justify-content:space-between;align-items:center;margin:4px 0;}
.set-field input{width:60px;text-align:center;}
#overlayTimer{
 position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
 background:#000C;border:2px solid #FF6600;color:#FF6600;
 border-radius:10px;padding:10px 20px;font-size:22px;
 display:none;z-index:9999;
}
</style>

<div id="dashboardContent">
  <img src="https://i.postimg.cc/jSH3RVPg/file-00000000673871f4a581a91702a2faa8.png" alt="Dashboard Header">
  <h2>Workout Tracker</h2>
  <label>Date:</label>
  <input type="date" id="wDate">
  <br>
  <label>Focus:</label>
  <select id="wFocus"></select>
  <div id="exerciseArea"></div>
  <button onclick="endWorkout()">‚úÖ End Workout</button>
  <button onclick="showSection('menu')">üè† Menu</button>
</div>

<div id="overlayTimer"></div>

<script>
/* Data store */
const sfState=JSON.parse(localStorage.getItem('savfitState')||'{}');
if(!sfState.logs)sfState.logs=[];

/* Focus groups */
const focusMap={
 "Chest & Back":["Flat Dumbbell Bench Press","Pull-Ups / Lat Pulldown","Incline Dumbbell Bench Press","Bent-Over Row","Dumbbell Fly"],
 "Legs & Glutes":["Back Squat","Romanian Deadlift","Standing Calf Raise","Walking Lunges","Hip Thrust"],
 "Shoulders & Mixed":["Deadlift","Overhead Press","Lateral Raise","Rear Delt Raise","Ab Roller"]
};

/* Populate focus list */
const fSel=document.getElementById('wFocus');
fSel.innerHTML=`<option value="">Select</option>`+
 Object.keys(focusMap).map(k=>`<option>${k}</option>`).join('');

fSel.onchange=()=>loadExercises(fSel.value);

function loadExercises(focus){
 const exArea=document.getElementById('exerciseArea');
 exArea.innerHTML='';
 if(!focus)return;
 focusMap[focus].forEach(ex=>{
   const div=document.createElement('div');
   div.className='exercise-card';
   div.innerHTML=`<h3>${ex}</h3>
   Weight (kg): <input type="number" class="weight"><br>
   Sets: <input type="number" class="numSets" min="1" max="10" value="3"
     onchange="populateSets(this)">
   <div class="sets"></div>`;
   exArea.appendChild(div);
   populateSets(div.querySelector('.numSets'));
 });
}

/* Populate dynamic set fields */
function populateSets(input){
 const parent=input.closest('.exercise-card');
 const num=parseInt(input.value)||0;
 const setsDiv=parent.querySelector('.sets');
 setsDiv.innerHTML='';
 for(let i=1;i<=num;i++){
   const set=document.createElement('div');
   set.className='set-field';
   set.innerHTML=`Set ${i}: <input type="number" min="1" class="reps" placeholder="Reps">
   <button onclick="saveSet(this)">üíæ</button>`;
   setsDiv.appendChild(set);
 }
}

/* Save set */
function saveSet(btn){
 const card=btn.closest('.exercise-card');
 const exName=card.querySelector('h3').innerText;
 const date=document.getElementById('wDate').value||new Date().toISOString().split('T')[0];
 const focus=document.getElementById('wFocus').value||'Custom';
 const weight=card.querySelector('.weight').value;
 const repsArr=[...card.querySelectorAll('.reps')].map(r=>r.value);
 let log=sfState.logs.find(l=>l.date===date&&l.focus===focus);
 if(!log){log={date,focus,data:[]};sfState.logs.push(log);}
 let ex=log.data.find(d=>d.name===exName);
 if(!ex){ex={name:exName,weight,reps:[]};log.data.push(ex);}
 ex.weight=weight;
 ex.reps=repsArr;
 localStorage.setItem('savfitState',JSON.stringify(sfState));
 btn.textContent='‚úÖ';
 setTimeout(()=>btn.textContent='üíæ',800);
}

/* Overlay rest timer with vibration */
let timerInt;
function startRest(seconds=sfState.settings?.rest||60){
 const overlay=document.getElementById('overlayTimer');
 let t=seconds;
 overlay.style.display='block';
 overlay.textContent=`Rest: ${t}s`;
 clearInterval(timerInt);
 timerInt=setInterval(()=>{
   t--;
   if(t<=0){
     clearInterval(timerInt);
     overlay.textContent='Rest over! üí•';
     if('vibrate' in navigator)navigator.vibrate([300,150,300,150,500]);
     setTimeout(()=>overlay.style.display='none',1500);
   }else{
     overlay.textContent=`Rest: ${t}s`;
   }
 },1000);
}

/* End workout */
function endWorkout(){
 localStorage.setItem('savfitState',JSON.stringify(sfState));
 alert('Workout saved ‚úÖ');
 document.getElementById('exerciseArea').innerHTML='';
 document.getElementById('wFocus').value='';
 showSection('menu');
}
</script>
<!-- ==== END PART 2 ==== -->
<!-- ==== PART 3: PROGRESS + SETTINGS + HELP + ABOUT ==== -->
<style>
#progress,#settings,#help,#about{padding:20px;text-align:center;}
canvas{background:#111;border:1px solid #FF6600;border-radius:8px;margin:20px auto;display:block;}
h2{color:#FF6600;}
.modalBtn{margin:10px;}
pre{white-space:pre-wrap;text-align:left;color:#FF9933;}
</style>

<!-- Progress Section -->
<div id="progressContent">
 <h2>Progress Summary</h2>
 <select id="progSelect"></select>
 <canvas id="progChart" width="360" height="200"></canvas>
 <div id="progDetails"></div>
 <button onclick="showSection('menu')">üè† Menu</button>
</div>

<!-- Settings -->
<div id="settingsContent">
 <h2>Settings</h2>
 <label>Default rest time (seconds):</label>
 <input type="number" id="restTime" min="10" max="300" value="60"><br>
 <label><input type="checkbox" id="vibOn"> Enable vibration</label><br>
 <button onclick="saveSettings()">üíæ Save Settings</button>
 <button onclick="showSection('menu')">üè† Menu</button>
</div>

<!-- Help -->
<div id="helpContent">
 <h2>Help & Quick Tips</h2>
 <pre>
üèãÔ∏è Dashboard
- Select Focus & Date.
- Enter Weight and Sets.
- For each Set enter Reps then tap üíæ to save.
- Tap üïí icon to start rest timer.
- Tap ‚úÖ End Workout when done.

üìà Progress
- Choose exercise from dropdown to view chart.
- Tap points to see details.

üíæ Backup
- Use Export / Import buttons in browser console.

‚öôÔ∏è Settings
- Adjust rest time & vibration.
 </pre>
 <button onclick="showSection('menu')">üè† Menu</button>
</div>

<!-- About -->
<div id="aboutContent">
 <h2>About SavFit v0.3</h2>
 <p>Created for Savita by the best bro ever ‚ù§Ô∏è</p>
 <p>¬© 2025 SavFit Training App</p>
 <button onclick="showSection('menu')">üè† Menu</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
/* SETTINGS persistence */
if(!sfState.settings)sfState.settings={rest:60,vibrate:true};
document.getElementById('restTime').value=sfState.settings.rest||60;
document.getElementById('vibOn').checked=sfState.settings.vibrate||true;
function saveSettings(){
 sfState.settings.rest=parseInt(document.getElementById('restTime').value)||60;
 sfState.settings.vibrate=document.getElementById('vibOn').checked;
 localStorage.setItem('savfitState',JSON.stringify(sfState));
 alert('Settings saved ‚úÖ');
}

/* PROGRESS CHART */
const pSel=document.getElementById('progSelect');
function loadProgressExercises(){
 const allNames=[...new Set(sfState.logs.flatMap(l=>l.data.map(d=>d.name)))];
 pSel.innerHTML='<option>Select exercise</option>'+allNames.map(n=>`<option>${n}</option>`).join('');
}
pSel.onchange=renderChart;
function renderChart(){
 const ex=pSel.value;if(!ex)return;
 const pts=[];
 sfState.logs.forEach(l=>{
   const d=l.data.find(x=>x.name===ex);
   if(d)pts.push({date:l.date,weight:parseFloat(d.weight)||0,reps:d.reps.join('/'),focus:l.focus});
 });
 pts.sort((a,b)=>new Date(a.date)-new Date(b.date));
 const ctx=document.getElementById('progChart');
 if(window.chart)window.chart.destroy();
 window.chart=new Chart(ctx,{type:'line',
   data:{labels:pts.map(p=>p.date),
         datasets:[{label:ex,data:pts.map(p=>p.weight),
         borderColor:'#FF6600',backgroundColor:'#FF660044',tension:0.3,fill:true}]},
   options:{plugins:{legend:{labels:{color:'#FF9933'}}},
            scales:{x:{ticks:{color:'#FF9933'}},y:{ticks:{color:'#FF9933'}}},
            onClick:(e,els)=>{
              if(!els.length)return;
              const i=els[0].index;const p=pts[i];
              document.getElementById('progDetails').innerHTML=
                `<h3>${p.date}</h3><p>Focus: ${p.focus}<br>Weight: ${p.weight} kg<br>Reps: ${p.reps}</p>`;
            }}});
}

/* INITIAL LOAD */
window.addEventListener('load',()=>{loadProgressExercises();});
</script>
 <!-- ==== PHASE 1: OVERLAY + LOG + BACKUP/RESTORE ==== -->
<style>
/* Overlay spinner */
#loaderOverlay{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:rgba(0,0,0,0.8);color:#FF6600;
 display:none;align-items:center;justify-content:center;
 flex-direction:column;z-index:99999;font-size:20px;
}
#loaderOverlay .spinner{
 border:4px solid #111;border-top:4px solid #FF6600;
 border-radius:50%;width:60px;height:60px;
 animation:spin 1s linear infinite;margin-bottom:15px;
}
@keyframes spin{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}

/* Exercise log + backup modals */
.modal{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:#000E;color:#FF6600;overflow:auto;
 display:none;flex-direction:column;align-items:center;
 z-index:9999;padding:20px;
}
.modal h2{margin-top:30px;}
.modal table{border-collapse:collapse;width:90%;margin-top:10px;}
.modal th,.modal td{border:1px solid #FF6600;padding:6px;font-size:14px;text-align:center;}
.modal button{margin:8px;}
</style>

<!-- Loader overlay -->
<div id="loaderOverlay">
  <div class="spinner"></div>
  <p>Saving your gains...</p>
</div>

<!-- Exercise Log -->
<div id="logModal" class="modal">
  <h2>üìÖ Exercise Log</h2>
  <div id="logContent">No workouts yet.</div>
  <button onclick="closeLog()">Close</button>
</div>

<!-- Backup / Restore -->
<div id="backupModal" class="modal">
  <h2>üíæ Backup & Restore</h2>
  <button onclick="exportCSV()">Export CSV</button>
  <input type="file" id="fileInput" accept=".csv" style="display:none" onchange="importCSV(event)">
  <button onclick="document.getElementById('fileInput').click()">Import CSV</button>
  <button onclick="closeBackup()">Close</button>
</div>

<script>
/* ---------- Overlay handling ---------- */
function showLoader(msg="Saving your gains..."){
  const o=document.getElementById('loaderOverlay');
  o.querySelector('p').innerText=msg;
  o.style.display='flex';
}
function hideLoader(){document.getElementById('loaderOverlay').style.display='none';}

/* ---------- Exercise Log ---------- */
function openLog(){
  const m=document.getElementById('logModal');
  const c=document.getElementById('logContent');
  c.innerHTML='';
  if(!sfState.logs.length){c.innerText='No workouts yet.';}
  else{
    const tbl=document.createElement('table');
    tbl.innerHTML='<tr><th>Date</th><th>Focus</th><th>Exercises</th></tr>';
    sfState.logs.forEach(l=>{
      const row=document.createElement('tr');
      row.innerHTML=`<td>${l.date}</td><td>${l.focus}</td><td>${l.data.length}</td>`;
      row.onclick=()=>{
        alert(
          l.data.map(
            d=>`${d.name}: ${d.weight}kg  [${d.reps.join(",")}]`
          ).join("\n")
        );
      };
      tbl.appendChild(row);
    });
    c.appendChild(tbl);
  }
  m.style.display='flex';
}
function closeLog(){document.getElementById('logModal').style.display='none';}

/* ---------- Backup / Restore ---------- */
function openBackup(){document.getElementById('backupModal').style.display='flex';}
function closeBackup(){document.getElementById('backupModal').style.display='none';}

function exportCSV(){
 try{
   showLoader("Exporting...");
   const s=JSON.parse(localStorage.getItem('savfitState')||'{"logs":[]}');
   if(!s.logs.length){alert("No data to export.");hideLoader();return;}
   let csv="Date,Focus,Exercise,Weight,Reps\n";
   s.logs.forEach(l=>{
     l.data.forEach(d=>{
       csv+=`${l.date},${l.focus},"${d.name}",${d.weight},"${d.reps.join("/")}"\n`;
     });
   });
   const blob=new Blob([csv],{type:"text/csv"});
   const url=URL.createObjectURL(blob);
   const a=document.createElement("a");
   a.href=url;a.download="SavFit_Backup.csv";a.click();
   URL.revokeObjectURL(url);
   hideLoader();alert("Backup exported ‚úÖ");
 }catch(e){console.error(e);hideLoader();alert("Export failed.");}
}

function importCSV(e){
 const f=e.target.files[0];if(!f)return;
 const r=new FileReader();
 r.onload=function(ev){
   try{
     showLoader("Importing...");
     const lines=ev.target.result.trim().split(/\r?\n/).slice(1);
     const logs=[];
     lines.forEach(line=>{
       const [date,focus,name,w,reps]=line.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/);
       let log=logs.find(l=>l.date===date&&l.focus===focus);
       if(!log){log={date,focus,data:[]};logs.push(log);}
       log.data.push({
         name:name.replace(/"/g,""),
         weight:w,
         reps:reps?reps.replace(/"/g,"").split("/"):[0]
       });
     });
     sfState.logs=logs;
     localStorage.setItem('savfitState',JSON.stringify(sfState));
     hideLoader();alert("Backup restored ‚úÖ");
   }catch(err){console.error(err);hideLoader();alert("Import failed.");}
 };
 r.readAsText(f);
}
</script>
<!-- ==== END PHASE 1 ==== -->
<!-- ==== PHASE 2: ANDROID-FEEL UI ==== -->
<style>
/* Top bar */
#topbar {
 position: fixed; top: 0; left: 0; width: 100%; height: 50px;
 background: #111; border-bottom: 2px solid #FF6600;
 display: flex; align-items: center; justify-content: space-between;
 color: #FF6600; padding: 0 14px; z-index: 2000;
}
#topbar h1 { font-size: 18px; margin: 0; }
#backBtn {
 background: none; border: none; color: #FF6600;
 font-size: 24px; cursor: pointer; padding: 4px 8px;
}

/* Transition animations */
.fade   { animation: fade 0.25s ease-in-out; }
.slideIn{ animation: slideIn 0.25s ease-out; }
.slideOut{ animation: slideOut 0.25s ease-in; }

@keyframes fade     { from{opacity:0;} to{opacity:1;} }
@keyframes slideIn  { from{transform:translateX(100%);} to{transform:translateX(0);} }
@keyframes slideOut { from{transform:translateX(0);} to{transform:translateX(-100%);} }
</style>

<div id="topbar">
  <button id="backBtn" onclick="navBack()">‚Üê</button>
  <h1 id="topTitle">SavFit</h1>
  <div style="width:28px"></div> <!-- spacer -->
</div>

<script>
/* ---------- Android-style navigation ---------- */
let navHistory = ['menu'];
function navTo(id){
  const cur = navHistory[navHistory.length-1];
  if(cur===id)return;
  document.getElementById(cur).classList.add('slideOut');
  setTimeout(()=>{ document.getElementById(cur).classList.add('hidden'); },250);
  document.getElementById(id).classList.remove('hidden');
  document.getElementById(id).classList.add('slideIn');
  navHistory.push(id);
  setTitle(id);
  vibrateTap();
}
function navBack(){
  if(navHistory.length<=1)return;
  const cur=navHistory.pop();
  const prev=navHistory[navHistory.length-1];
  document.getElementById(cur).classList.add('slideOut');
  setTimeout(()=>{
    document.getElementById(cur).classList.add('hidden');
    document.getElementById(prev).classList.remove('hidden');
    document.getElementById(prev).classList.add('slideIn');
    setTitle(prev);
  },250);
  vibrateTap();
}
function setTitle(id){
  const map={
    menu:"SavFit",
    dashboard:"Workout",
    progress:"Progress",
    settings:"Settings",
    help:"Help",
    about:"About",
    logModal:"Exercise Log",
    backupModal:"Backup"
  };
  document.getElementById('topTitle').innerText=map[id]||"SavFit";
}

/* Override old showSection to use navTo */
function showSection(id){ navTo(id); }

/* Light haptic feedback */
function vibrateTap(){
  try{ if('vibrate' in navigator) navigator.vibrate([25,20]); }catch(e){}
}

/* Ensure top bar doesn‚Äôt hide menu */
document.body.style.paddingTop="50px";
</script>
<!-- ==== END PHASE 2 ==== -->
<!-- ==== PHASE 3: UI POLISH + SHARE ==== -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
/* Font-Awesome button icons & smoother modal fade */
button i{margin-right:6px;}
.modal,.#loaderOverlay{
 transition:opacity 0.3s ease;
}
.modal.show,.#loaderOverlay.show{
 display:flex;opacity:1;
}
.modal.hide,.#loaderOverlay.hide{
 opacity:0;pointer-events:none;
}
button:active{transform:scale(0.96);}
</style>

<!-- Add a Share button to main menu -->
<script>
// --- Share handler ---
function shareApp(){
  const shareData={
    title:"SavFit v0.3",
    text:"Track your gains with SavFit üí™ ‚Äì download the app now!",
    url:window.location.href
  };
  if(navigator.share){
    navigator.share(shareData)
      .then(()=>console.log("shared"))
      .catch(err=>console.warn("Share cancelled",err));
  }else{
    prompt("Copy this SavFit link:",window.location.href);
  }
  vibrateTap();
}

// --- Enhance modal open/close animations ---
function fadeIn(el){el.classList.remove("hide");el.classList.add("show");}
function fadeOut(el){el.classList.remove("show");el.classList.add("hide");setTimeout(()=>{el.style.display="none";},300);}

// override for loader/modal show/hide
function showLoader(msg="Saving your gains..."){
 const o=document.getElementById('loaderOverlay');
 o.querySelector('p').innerText=msg;
 o.style.display='flex';fadeIn(o);
}
function hideLoader(){fadeOut(document.getElementById('loaderOverlay'));}

// integrate fade with log & backup modals
function openLog(){fadeIn(document.getElementById('logModal'));}
function closeLog(){fadeOut(document.getElementById('logModal'));}
function openBackup(){fadeIn(document.getElementById('backupModal'));}
function closeBackup(){fadeOut(document.getElementById('backupModal'));}
</script>

<!-- add Share button dynamically to menu after load -->
<script>
window.addEventListener('load',()=>{
 const m=document.getElementById('menu');
 const btn=document.createElement('button');
 btn.className='menu-btn';
 btn.innerHTML='<i class="fa-solid fa-share-nodes"></i>Share App';
 btn.onclick=shareApp;
 m.appendChild(btn);
});
</script>
<!-- ==== END PHASE 3 ==== -->
</body>
</html>
<!-- ==== END PART 3 / END OF FILE ==== -->
